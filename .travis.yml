language:                   python

python:                     3.6.7

cache:                      pip

jobs:
  include:
    - stage:                Testing

      install:
          - pip install -r requirements.txt

      script:
          - python Source/test.py

    - stage:                Deployment

      if:                   type != pull_request AND tag IS present

      install:
          - pip install pyminifier pbr

      before_script:
          - cd Source

      script:
          - find echo_lang -type f -name "*.py" -exec pyminifier --lzma --obfuscate-variables --outfile="{}" "{}" \;

      deploy:
          - provider:       pypi
            user:           "eevee1"
            password:       "$pypi_password"
            skip_cleanup:   true
            server:         https://test.pypi.org/legacy/
            distributions:  "sdist bdist_wheel"
            on:
                tags: true

          - provider:       pypi
            user:           "eevee1"
            password:       "$pypi_password"
            skip_cleanup:   true
            distributions:  "sdist bdist_wheel"
            on:
                tags: true

env:
    global:
        secure: ZLoNVVwztNYmWmEuetXkTVFqGlVT+bjQxFlCp2NqCSYeMRxYnphuAE/9DOLonMFNbSoPw1kKdHykPLFUboMUpefzosgNw3Fv7l72PoG1zOtVpGCPzdChVmN5aNZENPkFDBtJe8DGyh7rNzN3JmfmXFGcvtpLYBx5Xlfwnnm8VLzslJGnw2U4sbn11iilrWWzCi3H3a7kI/cmmG/G/ypudvRFiJXNtdnSCgBozQ0QtG94/u2L6115n5o1MNm1JM7UlyCZbz4oT2m3rVoqAZKpp+jPzRYs5F1nH0ZRtU44UTo6Yp7AJH1tuHH+Ts0QDu2L2kaBAK1MNr3i/2O1yZoyzbncapR3EZK1B36+5xEnFBpJHT25b9nFB0K7bOUUIcESxgMnXganLgBRzmoAK8AKGy3/3DgOk3ddv47ucpb1ya2PopEKHeXGabwsBM8Rz8zIUqGclKR5TxylVbO6q9oqjx4PsNYE5SwLPd2Wc1m8R3Bxv91bHjTZHz9TR+lKdCZ9iBsZXyFMSYvVnlttWp1i0UHhuqGH1TP9iZrv6isYCJKi4var3tbx3HUxjTRsH2ajd1jZ2acPouJq6in7EHEWrc08nZsToBWI2mWYvSEl8biHCFqqqwXf1PPOyiy6sqhuzigT0VDP7uag9j752nMffUBQ4AyJd5D2z7LLo7nZRZE=
